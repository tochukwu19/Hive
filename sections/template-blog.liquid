{% schema %}
  {
    "name": "Blog",
    "settings": [
      {
        "type": "text",
        "id": "blog_title",
        "label": "Blog Title",
        "default": "Our Blog"
      }, {
        "type": "select",
        "id": "layout",
        "label": "Layout",
        "options": [
          {
            "value": "grid",
            "label": "Grid"
          }, {
            "value": "list",
            "label": "List"
          }
        ],
        "default": "grid"
      }, {
        "type": "range",
        "id": "posts_per_page",
        "min": 3,
        "max": 24,
        "step": 3,
        "label": "Posts per page",
        "default": 9
      }
    ],
    "blocks": [
      {
        "type": "featured_image",
        "name": "Featured Image",
        "limit": 1
      }, {
        "type": "title",
        "name": "Title",
        "limit": 1
      }, {
        "type": "excerpt",
        "name": "Excerpt",
        "limit": 1
      }, {
        "type": "meta",
        "name": "Meta Information",
        "limit": 1
      }
    ]
  }
{% endschema %}

<div class="blog-container">
  <h1 class="blog-title">{{ section.settings.blog_title }}</h1>

  <div class="blog-posts {% if section.settings.layout == 'grid' %}blog-posts-grid{% else %}blog-posts-list{% endif %}">
    {% paginate blog.articles by section.settings.posts_per_page %}
      {% for article in blog.articles %}
        <article class="blog-post">
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'featured_image' %}
                {% if article.image %}
                  <a href="{{ article.url }}" class="blog-post-image-link">
                    {{ article.image | img_url: '400x' | img_tag: article.title, 'blog-post-image' }}
                  </a>
                {% endif %}

              {% when 'title' %}
                <h2 class="blog-post-title">
                  <a href="{{ article.url }}">{{ article.title }}</a>
                </h2>

              {% when 'excerpt' %}
                <div class="blog-post-excerpt">
                  {% if article.excerpt != blank %}
                    {{ article.excerpt }}
                  {% else %}
                    {{ article.content | strip_html | truncatewords: 30 }}
                  {% endif %}
                </div>

              {% when 'meta' %}
                <div class="blog-post-meta">
                  <span class="blog-post-date">{{ article.published_at | date: "%B %d, %Y" }}</span>
                  {% if article.comments_enabled? %}
                    <span class="blog-post-comments">{{ article.comments_count }} comments</span>
                  {% endif %}
                </div>
            {% endcase %}
          {% endfor %}
        </article>
      {% endfor %}

      {% if paginate.pages > 1 %}
        <nav class="pagination">
          {{ paginate | default_pagination }}
        </nav>
      {% endif %}
    {% endpaginate %}
  </div>
</div>

<style>
  .blog-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
    font-family: -apple-system
    , BlinkMacSystemFont
    , 'Segoe UI'
    , Roboto
    , Helvetica
    , Arial
    , sans-serif;
  }

  .blog-title {
    font-size: 2.5rem;
    color: #333;
    margin-bottom: 2rem;
    text-align: center;
  }

  .blog-posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }

  .blog-posts-list .blog-post {
    margin-bottom: 2rem;
  }

  .blog-post {
    background-color: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  .blog-post-image {
    width: 100%;
    height: auto;
    display: block;
  }

  .blog-post-title {
    font-size: 1.5rem;
    margin: 1rem;
  }

  .blog-post-title a {
    color: #333;
    text-decoration: none;
  }

  .blog-post-excerpt {
    font-size: 0.9rem;
    color: #666;
    margin: 0 1rem 1rem;
  }

  .blog-post-meta {
    font-size: 0.8rem;
    color: #999;
    margin: 0 1rem 1rem;
  }

  </style>

  <div class="py-8 blog w-[90%] mx-auto">
    {% paginate blog.articles by section.settings.number_of_blog_posts %}

        <h1 class="text-center text-3xl font-bold">{{ blog.title }}</h1>
        
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                {% for article in blog.articles %}
                    <div class="w-full py-6 px-3">
                        <div class="bg-white overflow-hidden">
                            {% if article.image %}
                                <a href="{{ article.url }}">
                                    <img class="w-full h-80 object-cover" src="{{ article.image | img_url: 'medium' }}" alt="{{ article.image.alt }}">
                                </a>
                            {% else %}
                                {{ 'image' | placeholder_svg_tag: 'w-full h-80 object-cover bg-gray-100' }}
                            {% endif %}

                            <div class="p-4">
                                <h1 class="text-xl text-[#CB8161] font-medium mt-4">{{ article.title }}</h1>

                                {% if article.excerpt.size > 0 %}
                                    <p class="text-[#777] font-medium">{{ article.excerpt | strip_html | truncatewords: 15 }}</p>
                                {% else %}
                                    <p class="text-[#777] font-medium">{{ article.content | strip_html | truncatewords: 15 }}</p>
                                {% endif %}

                                <a href="{{ article.url }}" class="font-medium text-gray-600 hover:text-[#CB8161] mb-4 block w-fit">{{ section.settings.blog_read_more }}</a>
                            </div>

                            
                        </div>
                        
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="max-w-6xl mx-auto">
            {% render 'pagination', pagination: paginate %}
        </div>
    {% endpaginate %}
</div>



{% schema %}
{
    "name": "Blog",
    "settings": [
        {
            "type": "text",
            "id": "blog_read_more",
            "label": "Read more label",
            "default": "Read more"
        },
        {
            "type": "range",
            "id": "number_of_blog_posts",
            "step": 1,
            "min": 1,
            "max": 6,
            "label": "Blog posts per page",
            "default": 3
        }
    ]
}
{% endschema %}
  .blog-post-comments {
    margin-right: 1rem;
  }

  .pagination {
    margin-top: 2rem;
    text-align: center;
  }

  @media (max-width: 768px) {
    .blog-posts-grid {
      grid-template-columns: 1fr;
    }
  }
</style>